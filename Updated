-- ACUSADO NINJA HUB - HACKER ELITE EDITION (ULTRA-SAFE + GUI CONTROLS)
-- KEY: BACK01 | ANTI-BAN ACTIVADO

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local LogService = game:GetService("LogService")

-- [SEGURIDAD ANTI-BAN]
local function Protect()
    pcall(function()
        for i,v in pairs(getconnections(LogService.MessageOut)) do v:Disable() end
    end)
    Players.PlayerAdded:Connect(function(plr)
        if plr:GetRankInGroup(1200769) > 20 then Players.LocalPlayer:Kick("STAFF") end
    end)
end
Protect()

-- LIMPIEZA
if CoreGui:FindFirstChild("AcusadoNinjaHub_V2") then CoreGui.AcusadoNinjaHub_V2:Destroy() end

local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "AcusadoNinjaHub_V2"
ScreenGui.ResetOnSpawn = false

-- PANEL PRINCIPAL
local Main = Instance.new("Frame", ScreenGui)
Main.Name = "Main"
Main.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Main.Size = UDim2.new(0, 230, 0, 340)
Main.Position = UDim2.new(0.05, 0, 0.3, 0)
Main.Active = true
Main.Draggable = true
Main.BorderSizePixel = 0

local Stroke = Instance.new("UIStroke", Main)
Stroke.Color = Color3.fromRGB(0, 255, 0)
Stroke.Thickness = 1.5

local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1, 0, 0, 35)
Title.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
Title.Text = "> ACUSADO NINJA HUB _"
Title.TextColor3 = Color3.fromRGB(0, 255, 0)
Title.Font = Enum.Font.Code
Title.TextSize = 15

-- BOTÓN CERRAR [X]
local CloseBtn = Instance.new("TextButton", Main)
CloseBtn.Size = UDim2.new(0, 25, 0, 25)
CloseBtn.Position = UDim2.new(1, -30, 0, 5)
CloseBtn.Text = "[X]"
CloseBtn.TextColor3 = Color3.fromRGB(0, 255, 0)
CloseBtn.BackgroundTransparency = 1
CloseBtn.Font = Enum.Font.Code
CloseBtn.TextSize = 18

-- BOTÓN RE-ABRIR (FLOTANTE)
local OpenBtn = Instance.new("TextButton", ScreenGui)
OpenBtn.Size = UDim2.new(0, 150, 0, 30)
OpenBtn.Position = UDim2.new(0, 10, 0.5, 0)
OpenBtn.Text = "> RE-OPEN TERMINAL"
OpenBtn.TextColor3 = Color3.fromRGB(0, 255, 0)
OpenBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
OpenBtn.Font = Enum.Font.Code
OpenBtn.Visible = false
Instance.new("UIStroke", OpenBtn).Color = Color3.fromRGB(0, 255, 0)

-- LÓGICA DE VISIBILIDAD
CloseBtn.MouseButton1Click:Connect(function() 
    Main.Visible = false 
    OpenBtn.Visible = true 
end)

OpenBtn.MouseButton1Click:Connect(function() 
    Main.Visible = true 
    OpenBtn.Visible = false 
end)

-- ESTADOS
_G.Hitbox = false
_G.Box = false
_G.Tracers = false
_G.Names = false

local function CreateBtn(name, pos, callback)
    local btn = Instance.new("TextButton", Main)
    btn.Size = UDim2.new(0.85, 0, 0, 32)
    btn.Position = pos
    btn.Text = "[ " .. name .. " ]"
    btn.BackgroundColor3 = Color3.fromRGB(5, 5, 5)
    btn.TextColor3 = Color3.fromRGB(0, 200, 0)
    btn.Font = Enum.Font.Code
    btn.BorderSizePixel = 0
    btn.MouseButton1Click:Connect(function() callback(btn) end)
    return btn
end

local SizeInput = Instance.new("TextBox", Main)
SizeInput.Size = UDim2.new(0.85, 0, 0, 30)
SizeInput.Position = UDim2.new(0.075, 0, 0.15, 0)
SizeInput.Text = "12"
SizeInput.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
SizeInput.TextColor3 = Color3.fromRGB(0, 255, 0)
SizeInput.Font = Enum.Font.Code

-- BOTONES DE FUNCIONES
CreateBtn("RUN_HITBOX", UDim2.new(0.075, 0, 0.28, 0), function(b)
    _G.Hitbox = not _G.Hitbox
    b.BackgroundColor3 = _G.Hitbox and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

CreateBtn("DRAW_BOX", UDim2.new(0.075, 0, 0.40, 0), function(b)
    _G.Box = not _G.Box
    b.BackgroundColor3 = _G.Box and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

CreateBtn("TRACE_TOP", UDim2.new(0.075, 0, 0.52, 0), function(b)
    _G.Tracers = not _G.Tracers
    b.BackgroundColor3 = _G.Tracers and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

CreateBtn("IDENTIFY_NAMES", UDim2.new(0.075, 0, 0.64, 0), function(b)
    _G.Names = not _G.Names
    b.BackgroundColor3 = _G.Names and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

-- LOOP SEGURO HITBOX
task.spawn(function()
    while task.wait(2) do
        if _G.Hitbox then
            local s = tonumber(SizeInput.Text) or 12
            for _, v in pairs(Players:GetPlayers()) do
                if v ~= Players.LocalPlayer and v.Character and v.Character:FindFirstChild("Head") then
                    pcall(function()
                        local h = v.Character.Head
                        h.Size = Vector3.new(s, s, s)
                        h.Transparency = 0.8
                        h.CanCollide = false
                        h.Massless = true
                    end)
                end
            end
        end
    end
end)

-- MOTOR ESP (BOX OUTLINE)
local function CreateESP(plr)
    local Box = Drawing.new("Square")
    local Tracer = Drawing.new("Line")
    local Name = Drawing.new("Text")

    RunService.RenderStepped:Connect(function()
        if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = plr.Character.HumanoidRootPart
            local pos, onScreen = Workspace.CurrentCamera:WorldToViewportPoint(hrp.Position)

            if onScreen then
                local sX, sY = 2200 / pos.Z, 2800 / pos.Z
                Box.Visible = _G.Box
                Box.Size = Vector2.new(sX, sY)
                Box.Position = Vector2.new(pos.X - sX/2, pos.Y - sY/2)
                Box.Color = Color3.fromRGB(0, 255, 0)
                Box.Filled = false -- Outline solamente
                Box.Thickness = 1

                Tracer.Visible = _G.Tracers
                Tracer.From = Vector2.new(Workspace.CurrentCamera.ViewportSize.X / 2, 0)
                Tracer.To = Vector2.new(pos.X, pos.Y - sY/2)
                Tracer.Color = Color3.new(1, 1, 1)

                Name.Visible = _G.Names
                Name.Text = "[ " .. plr.Name .. " ]"
                Name.Position = Vector2.new(pos.X, pos.Y - sY/2 - 18)
                Name.Center = true
                Name.Outline = true
                Name.Color = Color3.fromRGB(0, 255, 0)
            else
                Box.Visible = false; Tracer.Visible = false; Name.Visible = false
            end
        else
            Box.Visible = false; Tracer.Visible = false; Name.Visible = false
        end
    end)
end

for _, p in pairs(Players:GetPlayers()) do if p ~= Players.LocalPlayer then CreateESP(p) end end
Players.PlayerAdded:Connect(function(p) CreateESP(p) end)

print("> ACUSADO NINJA HUB V2 PROTECTED LOADED")
