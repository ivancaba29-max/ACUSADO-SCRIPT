-- // ACUSADO NINJA HUB - HACKER ELITE (ANTI-BAN SAFE) //
-- // KEY: BACK01 //

local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

-- TABLA INTERNA DE SEGURIDAD
local NinjaSettings = {
    HitboxActive = false,
    BoxActive = false,
    TracerActive = false,
    NamesActive = false,
    Size = 12
}

-- LIMPIEZA Y PROTECCIÓN DE GUI (NOMBRE ALEATORIO)
local GuiName = "ANH_" .. HttpService:GenerateGUID(false):sub(1,8)
if CoreGui:FindFirstChild(GuiName) then CoreGui[GuiName]:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = GuiName
ScreenGui.Parent = CoreGui
ScreenGui.ResetOnSpawn = false

-- PANEL ESTILO HACKER TERMINAL
local Main = Instance.new("Frame", ScreenGui)
Main.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Main.Size = UDim2.new(0, 230, 0, 340)
Main.Position = UDim2.new(0.05, 0, 0.3, 0)
Main.Active = true
Main.Draggable = true
Main.BorderSizePixel = 0

local Stroke = Instance.new("UIStroke", Main)
Stroke.Color = Color3.fromRGB(0, 255, 0)
Stroke.Thickness = 1.5

local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1, 0, 0, 35)
Title.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
Title.Text = "> ACUSADO NINJA HUB _"
Title.TextColor3 = Color3.fromRGB(0, 255, 0)
Title.Font = Enum.Font.Code
Title.TextSize = 15

local CloseBtn = Instance.new("TextButton", Main)
CloseBtn.Size = UDim2.new(0, 25, 0, 25)
CloseBtn.Position = UDim2.new(1, -30, 0, 5)
CloseBtn.Text = "[X]"
CloseBtn.TextColor3 = Color3.fromRGB(0, 255, 0)
CloseBtn.BackgroundTransparency = 1

local OpenBtn = Instance.new("TextButton", ScreenGui)
OpenBtn.Size = UDim2.new(0, 130, 0, 30)
OpenBtn.Position = UDim2.new(0, 10, 0.5, 0)
OpenBtn.Text = "> RE-OPEN TERMINAL"
OpenBtn.TextColor3 = Color3.fromRGB(0, 255, 0)
OpenBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
OpenBtn.Visible = false
Instance.new("UIStroke", OpenBtn).Color = Color3.fromRGB(0, 255, 0)

CloseBtn.MouseButton1Click:Connect(function() Main.Visible = false; OpenBtn.Visible = true end)
OpenBtn.MouseButton1Click:Connect(function() Main.Visible = true; OpenBtn.Visible = false end)

local function CreateBtn(name, pos, callback)
    local btn = Instance.new("TextButton", Main)
    btn.Size = UDim2.new(0.85, 0, 0, 32)
    btn.Position = pos
    btn.Text = "[ " .. name .. " ]"
    btn.BackgroundColor3 = Color3.fromRGB(5, 5, 5)
    btn.TextColor3 = Color3.fromRGB(0, 200, 0)
    btn.Font = Enum.Font.Code
    btn.MouseButton1Click:Connect(function() callback(btn) end)
    return btn
end

local SizeInput = Instance.new("TextBox", Main)
SizeInput.Size = UDim2.new(0.85, 0, 0, 30)
SizeInput.Position = UDim2.new(0.075, 0, 0.15, 0)
SizeInput.Text = "12"
SizeInput.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
SizeInput.TextColor3 = Color3.fromRGB(0, 255, 0)
SizeInput.Font = Enum.Font.Code
SizeInput.FocusLost:Connect(function() NinjaSettings.Size = tonumber(SizeInput.Text) or 12 end)

CreateBtn("RUN_HITBOX", UDim2.new(0.075, 0, 0.28, 0), function(b)
    NinjaSettings.HitboxActive = not NinjaSettings.HitboxActive
    b.TextColor3 = NinjaSettings.HitboxActive and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(0, 200, 0)
    b.BackgroundColor3 = NinjaSettings.HitboxActive and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

CreateBtn("DRAW_BOX", UDim2.new(0.075, 0, 0.40, 0), function(b)
    NinjaSettings.BoxActive = not NinjaSettings.BoxActive
    b.BackgroundColor3 = NinjaSettings.BoxActive and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

CreateBtn("TRACE_TOP", UDim2.new(0.075, 0, 0.52, 0), function(b)
    NinjaSettings.TracerActive = not NinjaSettings.TracerActive
    b.BackgroundColor3 = NinjaSettings.TracerActive and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

CreateBtn("IDENTIFY_NAMES", UDim2.new(0.075, 0, 0.64, 0), function(b)
    NinjaSettings.NamesActive = not NinjaSettings.NamesActive
    b.BackgroundColor3 = NinjaSettings.NamesActive and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(5, 5, 5)
end)

-- MOTOR HITBOX SEGURO
task.spawn(function()
    while task.wait(1) do
        if NinjaSettings.HitboxActive then
            for _, v in pairs(Players:GetPlayers()) do
                if v ~= Players.LocalPlayer and v.Character and v.Character:FindFirstChild("Head") then
                    pcall(function()
                        local head = v.Character.Head
                        if head.Size.Y ~= NinjaSettings.Size then
                            head.Size = Vector3.new(NinjaSettings.Size, NinjaSettings.Size, NinjaSettings.Size)
                            head.Transparency = 0.7
                            head.CanCollide = false
                            head.Massless = true
                        end
                    end)
                end
            end
        end
    end
end)

-- ESP MOTOR (BOX OUTLINE / NO FILL)
local function CreateESP(plr)
    local Box = Drawing.new("Square")
    Box.Thickness = 1.5
    Box.Filled = false -- << AQUÍ ESTÁ LA CORRECCIÓN
    Box.Transparency = 1

    local Tracer = Drawing.new("Line")
    local Name = Drawing.new("Text")

    RunService.RenderStepped:Connect(function()
        if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = plr.Character.HumanoidRootPart
            local pos, onScreen = Workspace.CurrentCamera:WorldToViewportPoint(hrp.Position)

            if onScreen then
                local sX, sY = 2200 / pos.Z, 2800 / pos.Z
                
                Box.Visible = NinjaSettings.BoxActive
                Box.Size = Vector2.new(sX, sY)
                Box.Position = Vector2.new(pos.X - sX/2, pos.Y - sY/2)
                Box.Color = Color3.fromRGB(0, 255, 0)

                Tracer.Visible = NinjaSettings.TracerActive
                Tracer.From = Vector2.new(Workspace.CurrentCamera.ViewportSize.X / 2, 0)
                Tracer.To = Vector2.new(pos.X, pos.Y - sY/2)
                Tracer.Color = Color3.fromRGB(255, 255, 255)

                Name.Visible = NinjaSettings.NamesActive
                Name.Text = "[ " .. plr.Name .. " ]"
                Name.Position = Vector2.new(pos.X, pos.Y - sY/2 - 18)
                Name.Center = true
                Name.Outline = true
                Name.Color = Color3.fromRGB(0, 255, 0)
            else
                Box.Visible = false; Tracer.Visible = false; Name.Visible = false
            end
        else
            Box.Visible = false; Tracer.Visible = false; Name.Visible = false
        end
    end)
end

for _, p in pairs(Players:GetPlayers()) do if p ~= Players.LocalPlayer then CreateESP(p) end end
Players.PlayerAdded:Connect(function(p) CreateESP(p) end)
